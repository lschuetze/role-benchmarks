# -*- mode: yaml -*-
# Config file for ReBench
default_experiment: all
default_data_file: 'benchmark.data'

#definition of benchmark suites
benchmark_suites:
    test-objectteams-classic-38:
        gauge_adapter: RebenchLog
        command: -Dot.weavable=../benchmarks/ObjectTeams/weavables.txt --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/classic-3.8.0/otre_min.jar -javaagent:./objectteams/classic-3.8.0/otredyn_agent.jar -jar ../benchmarks/ObjectTeams/benchmarks-classic-3.8.0.jar %(benchmark)s %(input)s %(variable)s
        input_sizes: [6]
        variable_values: &VALUES
            - 100
            - 223
            - 316
            - 500
            - 707
            - 1000
            - 1224
            - 1414
            - 1581
            - 1732
            - 1870
            - 2000
            - 2121
            - 2236
            - 2345
            - 2449
        benchmarks: &BENCHMARKS
            - benchmark.TeamBenchmark3
            - benchmark.TeamBenchmark4

    test-objectteams-indy-38:
        gauge_adapter: RebenchLog
        command: -Dot.weavable=../benchmarks/ObjectTeams/weavables.txt -Dotdyn.nodeg -Dotdyn.urt=0 --add-reads jdk.dynalink=ALL-UNNAMED --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/indy-3.8.0/otre_min.jar -javaagent:./objectteams/indy-3.8.0/otredyn_agent.jar -jar ../benchmarks/ObjectTeams/benchmarks-indy-3.8.0.jar %(benchmark)s %(input)s %(variable)s
        input_sizes: [6]
        variable_values: *VALUES
        benchmarks: *BENCHMARKS

    test-objectteams-indy-38-deg:
        gauge_adapter: RebenchLog
        command: -Dot.weavable=../benchmarks/ObjectTeams/weavables.txt --add-reads jdk.dynalink=ALL-UNNAMED --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/graceful-indy-3.8.0/otre_min.jar -javaagent:./objectteams/graceful-indy-3.8.0/otredyn_agent.jar -jar ../benchmarks/ObjectTeams/benchmarks-grace-indy-3.8.0.jar %(benchmark)s %(input)s %(variable)s
        input_sizes: [6]
        variable_values: *VALUES
        benchmarks: *BENCHMARKS

    jmh-objectteams-indy-38-deg-noop:
        gauge_adapter: JMH
        command: -Dot.weavable=../benchmarks/jmh-otj/weavables.txt --add-reads jdk.dynalink=ALL-UNNAMED --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/graceful-indy-3.8.0/otre_min.jar -javaagent:./objectteams/graceful-indy-3.8.0/otredyn_agent.jar -jar ../benchmarks/jmh-otj/target/jmh-otj-artefacts-graceful-infra.jar %(benchmark)s
        benchmarks: &JMH_BENCHMARKS_NOOP
            - ActiveCallinBenchmark
            - NoopBenchmark

    jmh-objectteams-classic-38-noop:
        gauge_adapter: JMH
        command: -Dot.weavable=../benchmarks/jmh-otj/weavables.txt --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/classic-3.8.0/otre_min.jar -javaagent:./objectteams/classic-3.8.0/otredyn_agent.jar -jar ../benchmarks/jmh-otj/target/jmh-otj-artefacts-classic-infra.jar %(benchmark)s
        benchmarks: *JMH_BENCHMARKS_NOOP

    jmh-objectteams-indy-38-deg-static:
        gauge_adapter: JMH
        command: -Dot.weavable=../benchmarks/jmh-otj/weavables.txt --add-reads jdk.dynalink=ALL-UNNAMED --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/graceful-indy-3.8.0/otre_min.jar -javaagent:./objectteams/graceful-indy-3.8.0/otredyn_agent.jar -jar ../benchmarks/jmh-otj/target/jmh-otj-artefacts-graceful-infra.jar %(benchmark)s -p cnt=%(variable)s
        variable_values: &VALUES_JMH_STATIC
            - 1
            - 10
            - 100
            - 1000
        benchmarks: &JMH_BENCHMARKS_STATIC
            - ManyReplaceCallinsBenchmark
            - ManyAfterCallinsBenchmark
            - ManyBeforeCallinsBenchmark

    jmh-objectteams-classic-38-static:
        gauge_adapter: JMH
        command: -Dot.weavable=../benchmarks/jmh-otj/weavables.txt --add-reads java.base=ALL-UNNAMED --add-reads jdk.localedata=ALL-UNNAMED -Xbootclasspath/a:./objectteams/classic-3.8.0/otre_min.jar -javaagent:./objectteams/classic-3.8.0/otredyn_agent.jar -jar ../benchmarks/jmh-otj/target/jmh-otj-artefacts-classic-infra.jar %(benchmark)s -p cnt=%(variable)s
        variable_values: *VALUES_JMH_STATIC
        benchmarks: *JMH_BENCHMARKS_STATIC
        
# a set of executables use for the benchmark execution
executors:
    # JVMs
    Java14:
        path: implementations/
        executable: java14.sh

# combining benchmark suites and executions
experiments:
    test-objectteams:
        suites:
            - test-objectteams-classic-38
            - test-objectteams-indy-38
            - test-objectteams-indy-38-deg
        executions:
            - Java14
    test-jmh-noop:
        suites:
            - jmh-objectteams-indy-38-deg-noop
            - jmh-objectteams-classic-38-noop
        executions:
            - Java14
    test-jmh-static:
        suites:
            - jmh-objectteams-indy-38-deg-static
            - jmh-objectteams-classic-38-static
        executions:
            - Java14